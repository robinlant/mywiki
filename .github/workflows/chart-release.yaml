name: Release Charts
on:
   push:
      branches:
         - main
         - chart_releaser_pipeline # TODO: test only remove later

jobs:
   release-charts:
      strategy:
         matrix:
            charts:
               - mywiki
      runs-on: ubuntu-latest
      steps:
         - uses: actions/checkout@v6

         - name: Filter no changes
           uses: dorny/paths-filter@v3
           id: changes
           with:
            filters: |
             changes:
               - helm/'${{ matrix.charts }}/**'

         - name: Configure Git
           run: |
             git config user.name "$GITHUB_ACTOR"
             git config user.email "$GITHUB_ACTOR@users.noreply.github.com"

         - name: Run chart-releaser
           uses: helm/chart-releaser-action@v1.7.0
           env:
             CR_TOKEN: "${{ secrets.GITHUB_TOKEN }}"
